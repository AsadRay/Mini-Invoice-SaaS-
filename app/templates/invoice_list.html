{% extends 'base.html' %}
{% block content %}
<link href="{{ url_for('static', filename='css/invoice_list.css') }}" rel="stylesheet">

<!-- Header -->
<div class="invoices-header">
    <div class="invoices-title">
        <i class="fas fa-file-invoice-dollar"></i>
        Invoices
    </div>
    <p class="invoices-subtitle">Manage and track all your invoices in one place</p>
</div>

<!-- Invoice Cards -->
{% if invoices %}
<div class="invoices-cards-container">
    {% for invoice in invoices %}
    <div class="invoice-card" data-href="{{ url_for('invoices.view_invoice', invoice_id=invoice.id) }}" style="cursor: pointer;">
        <div class="invoice-card-header">
            <div class="invoice-card-left">
                <span class="invoice-id">#{{ invoice.id }}</span>
                <div class="client-info">
                    <div class="client-avatar">
                        {{ invoice.client.name[0].upper() if invoice.client.name else 'C' }}
                    </div>
                    <span class="client-name">{{ invoice.client.name }}</span>
                </div>
            </div>
            <div class="invoice-card-right">
                <div class="invoice-amount">
                    ${{ '{:,.2f}'.format(invoice.total_amount) }}
                </div>
            </div>
        </div>
        
        <div class="invoice-card-body">
            <div class="invoice-dates">
                <div class="date-item">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Issued: {{ invoice.issue_date.strftime('%b %d, %Y') }}</span>
                </div>
                <div class="date-item">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ invoice.due_date.strftime('%b %d, %Y') }}</span>
                </div>
            </div>
        </div>
        
        <div class="status-and-actions">
            {% if invoice.status == 'paid' %}
                <span class="status-badge status-paid">
                    <i class="fas fa-check-circle"></i> Paid
                </span>
            {% elif invoice.due_date < current_time().date() %}
                <span class="status-badge status-overdue">
                    <i class="fas fa-exclamation-triangle"></i> Overdue
                </span>
            {% else %}
                <span class="status-badge status-unpaid">
                    <i class="fas fa-clock"></i> Unpaid
                </span>
            {% endif %}
            
            <div class="invoice-actions">
                <a href="{{ url_for('invoices.edit_invoice', invoice_id=invoice.id) }}" 
                   class="action-btn btn-edit" title="Edit Invoice">
                    <i class="fas fa-edit"></i>
                </a>
                
                <form method="POST" action="{{ url_for('invoices.delete_invoice', invoice_id=invoice.id) }}" 
                      style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this invoice?');">
                    <button type="submit" class="action-btn btn-delete" title="Delete Invoice">
                        <i class="fas fa-trash"></i>
                    </button>
                </form>
                
                {% if invoice.status != 'paid' %}
                <form method="POST" action="{{ url_for('invoices.mark_invoice_paid', invoice_id=invoice.id) }}" 
                      style="display:inline;">
                    <button type="submit" class="btn-paid" title="Mark as Paid">
                        <i class="fas fa-check"></i> Paid
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <div class="empty-state-icon">
        <i class="fas fa-file-invoice-dollar"></i>
    </div>
    <h3>No Invoices Found</h3>
    <p>You haven't created any invoices yet. Start by creating your first invoice.</p>
    <a href="{{ url_for('invoices.create_invoice') }}" class="btn-custom btn-primary-custom mt-3">
        <i class="fas fa-plus"></i>
        Create Your First Invoice
    </a>
</div>
{% endif %}
<script src="{{ url_for('static', filename='js/invoice_list.js') }}"></script>
{% endblock %}